---
title: "Models with Quadratics, Part II"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval=T)
```

## Lecture Video

**Embedded video:**[https://media.oregonstate.edu/media/t/0_yk8lee3h](https://media.oregonstate.edu/media/t/0_yk8lee3h)

## R Example
Open the `week5.R` script that we started previously and click the "Source" button to execute all of the commands. 

Consider the `lm_quad` model from the previous section, and recall the diminishing marginal returns as experience grows. If we continue to see what happens as experience accumulates, the diminishing marginal returns we predict might actually yield a predicted negative marginal effect of experience on wages. The point at which the marginal effect switches sign is called the *turning point*, and we can solve for it. The turning point occurs where the marginal effect is exactly zero, so we set:

$$\dfrac{\Delta Y}{\Delta X} = \widehat{\beta}_1 + 2\widehat{\beta}_2 X$$
$$0 = \widehat{\beta}_1 + 2\widehat{\beta}_2 X$$
$$X^* = -\dfrac{\widehat{\beta}_1}{2\widehat{\beta}_2}$$

In our example:

```{r, eval=T}
beta1hat <- coefficients(lm_quad)["exper"]
beta2hat <- coefficients(lm_quad)["expersqu"]
# Note the parentheses
xstar <- -beta1hat/(2*beta2hat)
xstar
```

*Note that these estimates are different from the ones in the lecture video.*

Now let's plot the education and expected wages:

```{r}
beta0hat <- coefficients(lm_quad)["(Intercept)"]
ggplot(data.frame(x=c(0, 30)), aes(x)) + 
    stat_function(fun=function(x) {
        beta0hat + beta1hat*x + beta2hat*x^2
    }) +
    geom_vline(xintercept=xstar, lty="dashed") +
    theme_bw() +
    xlab("Experience") +
    ylab("Predicted Wage")
```

## Test your knowledge
Suppose we include education in the previous regression. What is the new turning point?

<div id="spoiler" style="display:none">

```{r, eval=T}
lm_quad_educ <- lm(hrwage ~ exper + expersqu + educ, data=sleep75)
beta1hat <- coefficients(lm_quad_educ)["exper"]
beta2hat <- coefficients(lm_quad_educ)["expersqu"]
xstar <- -beta1hat/(2*beta2hat)
xstar
```

</div>

<button title="Click to Show/Hide Content" type="button" onclick="if(document.getElementById('spoiler') .style.display=='none') {document.getElementById('spoiler') .style.display=''}else{document.getElementById('spoiler') .style.display='none'}">Show/Hide Solution</button>



---

[Previous]() | [Table of contents]() | [Next]() 
