---
title: "Models with Quadratics, Part I"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval=F)
```

## Lecture Video

**Embedded video:**[https://media.oregonstate.edu/media/t/0_r0zmg6rb](https://media.oregonstate.edu/media/t/0_r0zmg6rb)

## R Example
Open the `week5.R` script that we started previously and click the "Source" button to execute all of the commands. 

Previously we discussed that the term “linear regression” refers to linearity in the parameters, not necessarily that the variables themselves have to enter linearly. For instance, taking logs is a non-linear transformation of a variable, but we can still estimate a linear regression model using these log transformations. Why would we take logs? We’ve seen that this can be useful in some cases when we want to estimate an elasticity, or when the data represents a non-linear relationship in levels but is closer to linear in log form. Another useful non-linear transformation is the quadratic form. For instance, the relationship
between earnings and experience is not really linear. Including experience alone as an independent variable is therefore likely to provide a poor fit to the data. A better way to model this relationship is by using a quadratic in experience:

$$wage = \beta_0 + \beta_1exper + \beta_2exper^2 + u$$

Let's estimate the equation using the `sleep75` dataset from the `wooldridge` package:

```{r, eval=T}
data(sleep75)
# Create squared experience data
sleep75$expersqu <- sleep75$exper^2
lm_quad <- lm(hrwage ~ exper + expersqu, data=sleep75)
# Alternative method: Note that we must use the I() function
#   if we want to square a variable without creating a new 
#   data column
# lm_quad <- lm(hrwage ~ exper + I(exper^2), data=sleep75)
summary(lm_quad)
```

*Note: These estimates are different from the ones in the lecture.*

For this regression, how should we think about the effect of a one-unit (year) change in experience? When experience increases by one year, it affects both the variables $exper$ and $exper^2$, so we need to be careful. Taking the slope with respect to $exper$ gives:

$$\dfrac{\Delta wage}{\Delta exper} = \beta_1 + 2\beta_2 exper$$

(Those who know calculus will recognize the right-hand side as the derivative of the regression equation with respect to $exper$.) Notice that when thinking about a one-unit change in experience, the slope is not just $\beta_1$. Moreover, the expression shows that the effect of a one-unit change in experience is not constant, but depends on the particular value of $exper$ that we consider.

Let’s think about what these estimates imply for the marginal effect of experience on wages. We first note that in our estimates, $\widehat{\beta}_1 > 0$ and $\widehat{\beta}_2 < 0$. This means that when $exper = 0$, gaining the first year of experience is associated with higher wages, because the $2\widehat{\beta}_2$ term drops out of the equation. But as one accumulates more experience, this positive effect is counterbalanced by the negative effect of the second term. In other words, the regression predicts diminishing marginal returns to experience, just like we see in the data. We could not predict such diminishing marginal returns by including $exper$ alone without the quadratic term.

## Practice Question
Suppose we include education in the previous regression. Do we still estimate that there are diminishing marginal returns to experience after we include this additional covariate?

<div id="spoiler" style="display:none">

```{r, eval=T}
lm_quad_educ <- lm(hrwage ~ exper + expersqu + educ, data=sleep75)
summary(lm_quad_educ)
```

The coefficient on $exper^2$ is $-0.003$, which is less than zero. We still observe diminishing marginal returns to experience.

</div>

<button title="Click to Show/Hide Content" type="button" onclick="if(document.getElementById('spoiler') .style.display=='none') {document.getElementById('spoiler') .style.display=''}else{document.getElementById('spoiler') .style.display='none'}">Show/Hide Solution</button>



---

[Previous](data_scaling_II.html) | [Table of contents](toc.html) | [Next](quadratics_II.html) 
