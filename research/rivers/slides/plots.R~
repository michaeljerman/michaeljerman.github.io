library(ggplot2)
library(ineq)

x <- c(2,5,9,20,30)
x1 <- c(0,0,0,0,1000)

ineq(x1,type="Gini")

plotLorenz <- function(x.in){
    x <- sort(x.in)
    if (min(x) > 0) {
        x <- c(0, x)
    }
    n <- length(x)
    total <- sum(x)
    x.cum <- cumsum(x)
    x.L <- x.cum/total
    p <- qplot((0:(n-1))/(n-1), x.L, geom="line",
               xlab="Percentile", ylab="Cumulative Share")
    p <- p + geom_point()
    p <- p + theme(
                 axis.line.x=element_line(color="black", size=1),
                 axis.line.y=element_line(color="black", size=1),
                 plot.margin = unit(c(.5,.5,.5,.5), "cm")
             )
    p <- p + geom_line(
                 data = data.frame(x=c(0,1), y=c(0,1)),
                 aes(x=x, y=y),
                 linetype=2
             )
    p <- p + expand_limits(x = 0, y = 0)
    p <- p + scale_x_continuous(expand = c(0, 0))
    p <- p + scale_y_continuous(expand = c(0, 0))
    return(p)
}

p <- plotLorenz(c(2,5,9,20,30))

p
ggsave("lorenz_test.png", p, height=4, width=4)
