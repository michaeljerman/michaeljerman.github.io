<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Satellite Inequality</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/white.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">

	<section>
	  <h2> Estimating Inequality and Growth Using Satellite Data </h2>
	  <h3> Michael Jerman </h3>
	  <p> Micro Group </p>
	  <p> February 10, 2017 </p>
	</section>
	
	<section data-autoslide="1500">
	  <h3> Outline </h3>
	  <ol>
	    <li class="fragment grow" data-fragment-index="1"> Introduction </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Measuring Inequality </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Data </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Estimation Procedure </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Preliminary Results </li>
	  </ol>
	</section>
	
	<section>
	  <ul>
	    <li> Large-scale projects are underway to collect international data on inequality </li>
	    <ul>
	      <li> The World Top Incomes Database (Alvaredo et al. 2011-2015) </li>
	      <li> World Wealth and Income Database (Alvaredo et al. 2016) </li>
	    </ul>
	  </ul>
	</section>

	<section>
	  <ul><li> Existing efforts are severely constrained </li></ul>
	  <blockquote>
	    "We stress the need for more democratic transparency on income and wealth dynamics and better access to administrative and financial data." (Alvaredo et al. 2016)
	  </blockquote>
	</section>

	<section>
	  <h3> Satellite Data </h3>
	  <ul>
	    <li> Wide reaching &mdash; covers $>99\%$ of the global population </li>
	    <li> Allows for the construction of panel data sets </li>
	    <ul> <li> Current data spans 1990-present </li> </ul>
	    <li> Limited dependence on official statistics or surveys </li>
	    <ul> <li> Sporadic census counts and administrative boundaries are the only "on the ground" data required </li> </ul>
	  </ul>
	</section>

	<section>
	  <h3> Estimating Inequality </h3>
	  <ul>
	    <li> Measures of inequality require data on economic activity at a disaggregated level </li>
	    <ul>
	      <li> Economic activity is estimated using luminosity (night-lights) measurements </li>
	      <li> Population distribution is estimated using a combination of reflectance, luminosity, and elevation data </li>
	      <li> District-level population is obtained from the Census of India </li>
	    </ul>
	  </ul>
	</section>

	<section>
	  <h3> Economic Activity </h3>
	  <p align="left"> Henderson et al. (2012), AER: </p>
	  <ul>
	    <li>Nighttime light luminosity is a strong proxy for GDP (Henderson et al. 2012) </li>
	    <li> The best-fitting model is linear in night-lights </li>
	    <li> Similar predictive power as electricity consumption </li>
	  </ul>
	</section>

	<section data-markdown>
	  ### Estimating Population
	  - Early attempts counted houses in aerial photographs
	  - Dasymetric mapping (Wright 1936)
	  - Lo (1989) introduces the use of satellite data
	  - Stevens et al. (2015) use proprietary data, parametric estimates of ground cover and machine learning techniques (Worldpop)
	</section>

	<section data-autoslide="1500">
	  <h3> Outline </h3>
	  <ol>
	    <li class="fragment fade-out" data-fragment-index="1"> Introduction </li>
	    <li class="fragment grow" data-fragment-index="1"> Measuring Inequality </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Data </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Estimation Procedure </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Preliminary Results </li>
	  </ol>
	</section>

	<section data-markdown>
	  ### Inequality Indices
	  - The distribution of income across $N$ individuals is:
	  $$ Y = (y_1, y_2, ..., y_N) $$
	  - An inequality index is a function $I: Y \rightarrow \mathbb{R}_+$
	  - $I(0) \Leftrightarrow y_i = y_j, ~\forall i,j$
	  - Properties: anonymity, Pigou-Dalton transfer principle, population principle 
	</section>

	<section>

	  <section data-markdown>
	    ### Two Problems
	    1. Satellites observe lights, not income $y_i$
	    2. Lights per person is estimated at a spatial scale, not an individual scale
	  </section>

	  <section data-markdown>
	    ### Income and Lights
	    - $\ell_i$: Light output for person $i$
	    - $y_i \approx \alpha \ell_i$
	    - $Y = (\alpha \ell_1, \alpha \ell_2, ..., \alpha \ell_N)$
	  </section>

	  <section data-markdown>
	    ### Scale Invariance
	    - An index $I(Y)$ is *scale invariant* if:

	    $$ I(Y) = I(\alpha Y) $$	    
	  </section>

	  <section data-markdown>
	    ### Spatial Resolution
	    - Lights per capita are estimated at a 5km spatial resolution
	    - Partition $Y$ into $G$ groups representing different pixels

	    $$ Y = Y^1, Y^2,..., Y^G $$
	  </section>

	  <section data-markdown>
	    ### Subgroup Additivity
	    - An index $I(Y)$ is *subgroup additive* if:

	    $$ I(Y) = \sum_{g=1}^G \alpha_g I(Y^g) + I(\bar{y}^1, \bar{y}^2,...,\bar{y}^G) $$
	  </section>

	  <section data-markdown>
	    ### Between-Group Inequality
	    - If $I(Y)$ is subgroup additive, then the between-group inequality measure is invariant to within-group inequality
	    - The between-group index measures the contribution of spatial inequality to aggregate inequality
	  </section>

	</section>

	<section>
	  <h3>Theil Index</h3>
	  $$ T(Y) = \frac{1}{N}\sum_{i=1}^N\frac{y_i}{\bar{y}}\ln\frac{y_i}{\bar{y}} $$

<p> $T(Y)$ is subgroup additive: </p>

	  $$ T(Y) = \sum_{g=1}^G \frac{N^g\bar{y}^g}{N\bar{y}} T(Y^g) + \sum_{g=1}^G\frac{N^g\bar{y}^g}{N\bar{y}}\ln \frac{\bar{y}^g}{\bar{y}} $$
	</section>

	<section>
	  <h3> Inter-pixel Inequality </h3>

	  $$ T_p(Y) = \sum_{g=1}^G\frac{N^g\bar{y}^g}{N\bar{y}}\ln \frac{\bar{y}^g}{\bar{y}} $$
	</section>
	
	<section data-autoslide="1500">
	  <h3> Outline </h3>
	  <ol>
	    <li class="fragment fade-out" data-fragment-index="1"> Introduction </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Measuring Inequality </li>
	    <li class="fragment grow" data-fragment-index="1"> Data </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Estimation Procedure </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Preliminary Results </li>
	  </ol>
	</section>

	<section>
	  
	  <section>
	    <h3> Data Sources </h3>
	    <ul>
	      <li> Terrestrial </li>
	      <ul>
		<li> Census of India </li>
		<ul>
		  <li> District level counts from 2001, 2011 </li>
		  <li> District administrative boundaries </li>
		</ul>
	      </ul>
	      <li> Extraterrestrial </li>
	      <ul>
		<li> Defense Meteorological Satellite Program </li>
		<li> Landsat </li>
		<li> Shuttle Radar Topography Mission </li>
	      </ul>
	    </ul>
	  </section>

	  <section data-markdown>
	    ### Defense Meteorological Satellite Program
	    - Designed to observe cloud cover at night (moonlight reflecting off clouds)
	    - Also detects artificial lights 
	    - Processed by the NOAA to account for saturation, cloud cover, and auroral activity
	    - Processed data available for 1990-1991, 1996-1997, 2000-2001, 2002-2003, 2004, 2005-2006, 2010-2011
	  </section>

	  <section data-markdown>
	    ### Landsat Program
	    - Satellites collect surface reflectance data across six spectral bands
	    - 16 day period
	    - Data begins in 1982
	    - Processed to ground-level reflectance by the USGS
	    - 1 arc-second resolution (~30 meters)
	  </section>

	  <section data-markdown>
	    ### Shuttle Radar Topography Mission
	    - Radar system onboard Space Shuttle Endeavour
	    - Recorded elevation over 11 day period in February, 2000
	  </section>
	  
	</section>
	
	<section>

	  <section data-markdown>
	    ### Estimation Data Set
	    - Mean and quartiles are calculated for each of the satellite sources at the district level for 2000-2001, 2010-2011 ($8\times 4 = 32$ covariates)
	    - The dependent variable is the log population density at the district level from census years 2001, 2011 ($N=604$)
	    - Kashmir and island states excluded
	  </section>
	  
 	  <section>
	    <iframe width=800 height=800 data-src="https://www.n2yo.com/leaflet.php?s=25682&size=large&all=1&me=10"></iframe>
	  </section>
	  <section data-background-video="../sat0.mp4">
	  </section>
	  <section data-background-video="../sat1.mp4">
	  </section>
	  <section data-background-video="../sat2.mp4">
	  </section>
	  <section data-background-video="../sat3.mp4">
	  </section>
	  <section data-background-video="../sat4.mp4">
	  </section>
	  <section data-background-video="../sat5.mp4">
	  </section>
	  <section data-background-video="../sat6.mp4">
	  </section>
	</section>

	<section data-autoslide="1500">
	  <h3> Outline </h3>
	  <ol>
	    <li class="fragment fade-out" data-fragment-index="1"> Introduction </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Measuring Inequality </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Data </li>
	    <li class="fragment grow" data-fragment-index="1"> Estimation Procedure </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Preliminary Results </li>
	  </ol>
	</section>

	<section data-markdown>
	  ### Estimation Procedure
	  1. Estimate population density at the district level
	  2. Aggregate the raw satellite data at a smaller spatial resolution (5km)
	  3. Predict the population density for each 5km pixel
	  4. Calculate lights per person at the pixel level
	  5. Use pixel-level predictions to calculate inequality
	</section>

	<section>
	  <h3> District-Level Model </h3>

	  $$ \ln(density_i) = f(S_i) + \epsilon_i $$

	  <ul>
	    <li> $S_i$ is a vector of satellite aggregates for district $i$ </li>
	    <li> There is no good theory that informs the shape of $f$ </li>
	    <li> There is likely a high degree of interaction between covariates </li>
	  </ul>
	</section>

	<section>

	  <section data-markdown>
	    ### Random Forest Algorithm
	    - A random forest (Breiman, 2001) is a collection of bootstrapped regression trees
	    - Each tree in the forest is a collection of binary decision nodes, randomized across covariates
	    - The fitted values are the average of the fitted values for each individual tree
	    - Trees are randomized in such a way that prevents overfitting
	  </section>

	  <section data-transition="convex-in fade-out">
	    <h3> Building a Regression Tree </h3>
	    <iframe width=800 height=400 data-src="plugin/treant-js-master/examples/collapsable/index.html"></iframe>
	    <p> &nbsp; </p>
	  </section>

	  <section data-transition="fade">
	    <h3> Building a Regression Tree </h3>
	    <iframe width=800 height=400 data-src="plugin/treant-js-master/examples/collapsable/index1.html"></iframe>
	    <p style="color:red"> Collect $N$ observations </p>
	  </section> 

	  <section data-transition="fade">
	    <h3> Building a Regression Tree </h3>
	    <iframe width=800 height=400 data-src="plugin/treant-js-master/examples/collapsable/index2.html"></iframe>
	    <p style="color:red"> Choose a decision rule for one of the covariates </p>
	  </section> 

	  <section data-transition="fade">
	    <h3> Building a Regression Tree </h3>
	    <iframe width=800 height=400 data-src="plugin/treant-js-master/examples/collapsable/index3.html"></iframe>
	    <p style="color:red"> Partition the data based on the decision rule </p>
	  </section>

	  <section data-transition="fade">
	    <h3> Building a Regression Tree </h3>
	    <iframe width=800 height=400 data-src="plugin/treant-js-master/examples/collapsable/index4.html"></iframe>
	    <p style="color:red"> Choose new decision rules for each subset </p>
	  </section> 

	  <section data-transition="fade">
	    <h3> Building a Regression Tree </h3>
	    <iframe width=800 height=400 data-src="plugin/treant-js-master/examples/collapsable/index5.html"></iframe>
	    <p style="color:red"> Repeat... </p>
	  </section> 

	  <section data-transition="fade">
	    <h3> Building a Regression Tree </h3>
	    <iframe width=800 height=400 data-src="plugin/treant-js-master/examples/collapsable/index6.html"></iframe>
	    <p style="color:red"> ...until each terminal node has one observation </p>
	  </section> 

	</section>

	<section data-markdown>
	  ### Choosing a Decision Rule
	  - Choose a partition value for covariate $X_i$
	  - Calculate the MSE of the dependent variable $Y$ for each of the two partitions
	  - Find the partition value that minimizes the sum of the MSEs
	  - Repeat for each covariate
	  - Choose the maximum MSE-reducing partition covariate/value
	</section>

	<section>
	  <h3> From Trees to Forests </h3>
	  <ul>
	    <li> The standard regression tree is overfit </li>
	    <li> Random forests randomize tree along two dimensions: </li>
	    <ol>
	      <li> Each tree is grown on a bootstrapped sample of size $N$ </li>
	      <li> At each node, a random subset of covariates are chosen to find the decision rule </li>
	    </ol>
	  </ul>
	</section>

	<section>

	  <section data-markdown>
	    ### Variable Importance
	    - Random forests are highly non-linear and discontinuous
	    - Marginal effects are impossible to calculate
	    - Measures of variable importance can be obtained by predicting out-of-bag observations with randomly permuted covariates
	  </section>

	  <section>
	    <img src="../html/importance.svg"></img>
	  </section>

	</section>


	<section data-autoslide="1500">
	  <h3> Outline </h3>
	  <ol>
	    <li class="fragment fade-out" data-fragment-index="1"> Introduction </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Measuring Inequality </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Data </li>
	    <li class="fragment fade-out" data-fragment-index="1"> Estimation Procedure </li>
	    <li class="fragment grow" data-fragment-index="1"> Preliminary Results </li>
	  </ol>
	</section>

	<section>

	  <section>
	    <h3> Predicting Smaller Resolutions </h3>
	    <ul>
	      <li> The random forest algorithm returns an estimated function $\hat{f}(\cdot)$</li>
	      <li>For each 5km pixel $p$, calculate $\hat{f}(S_p)$</li>
	      <li>Aggregate the predicted values up to the district level, and regress against known district-level density</li>
	      <li> $R^2 = 0.87$ </li>
	      <li> <a href="http://pages.uoregon.edu/mjerman/Research/sat_ineq/map5k.html">Link to full size map</a> </li>
	    </ul>

	  </section>

	  <section>
	    Raw Census Data
	    <img src="../html/rawdists.svg"></img>
	  </section>
	  

	  <section>
	    Estimated Population Density
	    <img src="../html/densest.svg"></img>
	  </section>


	  <section>
	    True vs. Predicted District Population
	    <img src="../html/pred_err_pop.svg"></img>
	  </section>

	  <section>
	    Prediction Error by District Area
	    <img src="../html/pred_err_area.svg"></img>
	  </section>

	  <section>
	    Prediction Error by Area, Density Weighted
	    <img src="../html/pred_err_area_weighted.svg"></img>
	  </section>

	  <section>
	    Prediction Error by District
	    <img src="../html/pred_err.svg"></img>
	  </section>

	</section>

	<section>
	  
	  <section>
	    <h3> Per-capita output </h3>
	    Using lights as a proxy for output, per-capita GDP is:

	    $$ \bar{y}_p = \dfrac{\bar{\ell}_p}{\hat{f}(S_p)} $$
	  </section>
	  
	  <section>
	    Estimated Per-capita Output
	    <img src="../html/percapest.svg"></img>
	  </section>

	  <section>
	    Estimated District Inequality
	    <img src="../html/ineqdist.svg"></img>
	  </section>

	<section>
	  <p> Kuznets Curve </p>
	  
	  <img src="../html/kuznets.svg"></img>
	</section>

	<section>
	  <p> Kuznets Curve, Area Weighted </p>
	  
	  <img src="../html/kuznets_weighted.svg"></img>
	</section>

	<section>
	  <p> Kuznets Curve, Density Weighted </p>
	  
	  <img src="../html/kuznets_weighted_dens.svg"></img>
	</section>

	</section>


      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
      history: true,
      backgroundTransition: 'none',
      transition: 'convex',
      viewDistance: 2,
      controls: false,

      // More info https://github.com/hakimel/reveal.js#dependencies
      dependencies: [
      { src: 'plugin/title-footer/title-footer.js', async: true, callback: function() { title_footer.initialize(); } },
      { src: 'plugin/chalkboard/chalkboard.js' },
      { src: 'plugin/markdown/marked.js' },
      { src: 'plugin/markdown/markdown.js' },
      { src: 'plugin/notes/notes.js', async: true },
      { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'plugin/math-katex/math-katex.js', async: true }
      ],

      keyboard: {
        67: function() { RevealChalkboard.toggleNotesCanvas() },
        66: function() { RevealChalkboard.toggleChalkboard() }, 
        46: function() { RevealChalkboard.clear() },    
         8: function() { RevealChalkboard.reset() },    
        68: function() { RevealChalkboard.download() }, 
      },

      chalkboard: { 
      theme: "whiteboard",
      color: [ 'rgba(0,0,0,1)', 'rgba(255,255,255,0.5)' ]
      },
      
      });
    </script>
  </body>
p</html>
